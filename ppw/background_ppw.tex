\section{Background}
In this section, we first present the Amdahl's law and performance-per-watt's traditional expression in multi-core processor. Then the static power modeling and thermal modeling is introduced, with which we can write the revised expression of performance-per-watt in multi-core processor.

\subsection{Amdahl's law}
Amdahl's law put an upper bound for the speedup that a multi-core processor can achieve by parallelization as:
\begin{equation}\label{speedup}
Perf = \frac{1} {(1-f)+f/n}
\end{equation}
where $n$ is the number of cores, and $f$ is the fraction of a program's execution time that is parallelizable (0<$f$<1). Noted that, (1) is purely theroretical for it doesn't consider any constraints such as power budget.

The average power consumption of the many-core processor is as follows:
\begin{equation}\label{average_power}
W = \frac{P_{1} \times (1-f)+P_{n} \times f/n}{(1-f)+f/n}
\end{equation}
$P_{1}$ is the power consumption during the sequential computation process, $P_{n}$ is the power consumption during the parallel computation process.

$Perf/W$ of a many-core processor is expressed as:
\begin{equation}\label{ppw}
\begin{split}
\frac{Perf}{W} &= \frac{1}{(1-f)+f/n} \times \frac{(1-f)+f/n}{P_{1} \times (1-f)+P_{n} \times f/n}\\
&= \frac{1}{P_{1} \times (1-f)+P_{n} \times f/n}
\end{split}
\end{equation}

$P_{1}$ is composed of power consumption of 1 active core and $n-1$ idle cores, in previous works, due to lack of consideration of thermal constraints, $P_{1}$ is expressed as $1+(n-1)k$, in which $k$ stands for the fraction of power the processor consumes in idle state $(0 \le k \le 1)$. For parallel computation phase, $P_{n}$ consists of power consumption of $n$ active cores, which is previously defined as $n$.

\subsection{Static power modeling}

It is widely acknowledged that the total power of a chip is composed of dynamic and static power. The dynamic power is dependent on the activities of the chip, therefore it's easily estimated by methods implemented with performance counter. Yet the static power $p_{s}$ of the chip is caused by leakage current $I_{leak}$ as:
\begin{equation}\label{ps}
p_{s} = V_{dd}I_{leak}
\end{equation}
Due to the non-linear relationship between $I_{leak}$ and temperature, static power is also sensitive to temperature, which makes it hard to obtain. 

$I_{leak}$ is composed of many components, including subthreshold current, gate current, reverse-biased junction leakage current, et cetera. Among which, subthreshold current and gate current are the main parts of leakage current, therefore $I_{leak}$ can be approximated as:
\begin{equation}\label{I_leak}
I_{leak}=I_{sub}+I_{gate}
\end{equation}

Noted that $I_{gate}$ is cause by tunneling between the gate terminal and the other three terminals, does not depend on temperature and can be considered as a technology-dependent constant. Yet $I_{sub}$ is considered to be highly related to temperature, and can be modeled in the commonly accepeted MOSFET transitor model BSIM 4 as:
\begin{equation}\label{I_sub}
I_{sub}=Kv_{T}^{2}e^{\frac{V_{GS}-V_{th}} {\eta v_{T}}} (1-e^{\frac {-V_{DS}} {v_{T}} })\approx Kv_{T}^{2}e^{\frac{V_{GS}-V_{th}}{\eta v_{T}}}
\end{equation}

\subsection{Thermal modeling}
To estimate the power consumption of a IC chip, we first divide the chip and its package into multiple blocks called thermal nodes. Then, the thermal resistance and capacitance among these thermal nodes is computed. With above mentioned information, the thermal mdoel for a chip with $n$ total thermal nodes can be generated:
\begin{equation}\label{gt=bp}
\begin{split}
GT(t) + C\frac{dT(t)}{dt} &= BP_{T,t}\\
Y(t) &= LT_{t}
\end{split}
\end{equation}
where $T(t) \in \mathbb{R}^n$ is the temperature vector (distinguished from $T_p$, which is a scalar representing temperature at only one place), representing temperatures at $n$ places of the chip and package; $G \in \mathbb{R}^{n\times n}$ and  $C \in \mathbb{R}^{n \times n}$ contain equivalent thermal resistance and capacitance information respectively; $B \in \mathbb{R}^{n \times l}$ stores the information of how powers are injected into the thermal nodes; $P(T, t) \in \mathbb{R}^{l}$ is the power vector, which contains power consumptions of $l$ components on chip, including both dynamic power vector $P_d$ and static power vector $P_s$, i.e., $P(T, t)=P_s(T, t)+P_d(t)$, reminding that static power $P_s(T, t)$ is actually a function of temperature $T$;  $Y(t) \in \mathbb{R}^m$ is the output temperature vector, containing only temperatures of thermal nodes that the user is interested in, for example, thermal nodes on the chip only (excluding package thermal nodes); $L \in \mathbb{R}^{m \times n}$ is the corresponding output selection matrix which selects the $m$ chip temperatures from $T(t)$.

By applying thermal model, the effect of temperature on cores can be introduced. 
Through ergodic method, the distribution of light core with the maximum PPW
for number of light core from 1 to n can be specified.




